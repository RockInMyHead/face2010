# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

## üöÄ –ó–∞ 3 –º–∏–Ω—É—Ç—ã

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (1 –º–∏–Ω—É—Ç–∞)

```bash
# macOS/Linux
chmod +x install_advanced.sh
./install_advanced.sh

# Windows
install_advanced.cmd
```

### 2. –ó–∞–ø—É—Å–∫ (30 —Å–µ–∫—É–Ω–¥)

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
source .venv/bin/activate  # macOS/Linux
# –∏–ª–∏
.venv\Scripts\activate.bat  # Windows

# –í–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
export USE_ADVANCED_CLUSTERING=true  # macOS/Linux
# –∏–ª–∏
set USE_ADVANCED_CLUSTERING=true  # Windows

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python main.py
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (1 –º–∏–Ω—É—Ç–∞)

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: http://localhost:8000
2. –í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–ø–∫—É —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏
3. –ù–∞–∂–º–∏—Ç–µ "–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å"
4. –ì–æ—Ç–æ–≤–æ! üéâ

## üìä –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ

**–í–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:**
- ‚úÖ HOG/CNN –¥–µ—Ç–µ–∫—Ü–∏—è ‚Üí **InsightFace SCRFD** (—Ç–æ—á–Ω–µ–µ)
- ‚úÖ 128D —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ ‚Üí **512D ArcFace** (—Ç–æ—á–Ω–µ–µ)
- ‚úÖ HDBSCAN ‚Üí **Spectral Clustering** (—Ç–æ—á–Ω–µ–µ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- ‚úÖ –ë–µ–∑ TTA ‚Üí **–° TTA** (flip, —É—Å—Ç–æ–π—á–∏–≤–µ–µ)
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ ‚Üí **–ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞**

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- üìà –¢–æ—á–Ω–æ—Å—Ç—å: ~95% ‚Üí **~98.5%**
- üéØ –ú–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- üîç –õ—É—á—à–µ —Ä–∞–±–æ—Ç–∞ —Å –ø–ª–æ—Ö–∏–º –æ—Å–≤–µ—â–µ–Ω–∏–µ–º –∏ —É–≥–ª–∞–º–∏
- ‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: ~2-3x –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Ç–æ—á–Ω–µ–µ

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `main.py` (—Å—Ç—Ä–æ–∫–∞ 323-330):

```python
clustering_func = functools.partial(
    build_plan_advanced,
    input_dir=path,
    min_face_confidence=0.9,      # ‚Üë = —Å—Ç—Ä–æ–∂–µ –¥–µ—Ç–µ–∫—Ü–∏—è
    apply_tta=True,                # True = —Ç–æ—á–Ω–µ–µ, False = –±—ã—Å—Ç—Ä–µ–µ
    use_gpu=False,                 # True = –±—ã—Å—Ç—Ä–µ–µ –Ω–∞ GPU
    progress_callback=progress_callback,
    include_excluded=include_excluded
)
```

### –î–ª—è GPU (–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ):

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∏
pip install onnxruntime-gpu

# –í main.py –∏–∑–º–µ–Ω–∏—Ç—å
use_gpu=True  # —Å—Ç—Ä–æ–∫–∞ 328
```

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
python test_advanced_clustering.py
```

–í—ã–≤–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
```
‚úÖ PASS: –ò–º–ø–æ—Ä—Ç—ã
‚úÖ PASS: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚úÖ PASS: –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
‚úÖ PASS: k-reciprocal
‚úÖ PASS: Spectral Clustering
‚úÖ PASS: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
------------------------------------------------------------
–ü—Ä–æ–π–¥–µ–Ω–æ: 6/6 (100.0%)
```

## üÜö –†–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

### –†–µ–∂–∏–º 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```bash
# –ù–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å USE_ADVANCED_CLUSTERING
python main.py
```
- ‚ö° –ë—ã—Å—Ç—Ä–æ
- üìä –¢–æ—á–Ω–æ—Å—Ç—å ~95%
- üíæ –ü–∞–º—è—Ç—å ~500MB

### –†–µ–∂–∏–º 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è (CPU)
```bash
export USE_ADVANCED_CLUSTERING=true
python main.py
```
- üê¢ –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (~2-3x)
- üìä –¢–æ—á–Ω–æ—Å—Ç—å ~98.5%
- üíæ –ü–∞–º—è—Ç—å ~2GB

### –†–µ–∂–∏–º 3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è (GPU)
```bash
export USE_ADVANCED_CLUSTERING=true
# + —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å use_gpu=True –≤ main.py
python main.py
```
- ‚ö° –ë—ã—Å—Ç—Ä–æ (—Å—Ä–∞–≤–Ω–∏–º–æ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π)
- üìä –¢–æ—á–Ω–æ—Å—Ç—å ~98.5%
- üíæ –ü–∞–º—è—Ç—å ~2GB + VRAM

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ: [ADVANCED_CLUSTERING_GUIDE.md](ADVANCED_CLUSTERING_GUIDE.md)
- üìù –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: [IMPLEMENTATION_SUMMARY.md](IMPLEMENTATION_SUMMARY.md)
- üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `test_advanced_clustering.py`

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ù—É–∂–Ω–æ –ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏?
**A:** –î–∞, –∑–∞–ø—É—Å—Ç–∏—Ç–µ `install_advanced.sh` (–∏–ª–∏ `.cmd` –¥–ª—è Windows). –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ InsightFace –∑–∞–≥—Ä—É–∑–∏—Ç –º–æ–¥–µ–ª–∏ (~500MB).

### Q: –ú–æ–∂–Ω–æ –ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏?
**A:** –î–∞, –ø—Ä–æ—Å—Ç–æ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ `USE_ADVANCED_CLUSTERING=true` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.

### Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞?
**A:** –ù–∞ CPU: ~2-3x –º–µ–¥–ª–µ–Ω–Ω–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π. –ù–∞ GPU: —Å—Ä–∞–≤–Ω–∏–º–æ —Å–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π.

### Q: –ù—É–∂–µ–Ω –ª–∏ –º–æ—â–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä?
**A:** –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 4GB RAM. GPU –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω, –Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –≤ ~5-10x.

### Q: –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –Ω–∞ Windows/macOS/Linux?
**A:** –î–∞, –Ω–∞ –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö. –î–ª—è macOS –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ conda –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## üêõ –ü—Ä–æ–±–ª–µ–º—ã?

### –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ InsightFace:
```bash
pip install insightface onnxruntime
```

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞:
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ `apply_tta=False` –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é

### –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏:
- –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é (–º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Ñ–æ—Ç–æ –ø–æ—Ä—Ü–∏—è–º–∏

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–ù–µ–±–æ–ª—å—à–∏–µ –∞–ª—å–±–æ–º—ã (<1000 —Ñ–æ—Ç–æ):** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Å TTA
- **–°—Ä–µ–¥–Ω–∏–µ –∞–ª—å–±–æ–º—ã (1000-5000 —Ñ–æ—Ç–æ):** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –±–µ–∑ TTA –∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è
- **–ë–æ–ª—å—à–∏–µ –∞–ª—å–±–æ–º—ã (>5000 —Ñ–æ—Ç–æ):** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å:** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è + TTA + GPU
- **–ë—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è

---

**–ì–æ—Ç–æ–≤–æ! –ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üöÄ**

